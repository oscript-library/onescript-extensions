// Вызывается при сборке на хабе

ЗагрузитьСценарий(
	ОбъединитьПути(ТекущийСценарий().Каталог, "oslib", "packagedef"),
	Новый Структура("Описание", Описание));

Версия = Описание.Свойства().Версия;

Соединение = Новый HttpСоединение("https://github.com");
ВключаемыеФайлы = Описание.ВключаемыеФайлы();
Для Инд = 0 По ВключаемыеФайлы.Количество() - 1 Цикл

	мПутьКФайлуИсходный = ВключаемыеФайлы[Инд];
	мПутьКФайлу = ОбъединитьПути("oslib", мПутьКФайлуИсходный);
	мПутьКФайлуПолный = ОбъединитьПути(ТекущийСценарий().Каталог, мПутьКФайлу);

	Файл = Новый Файл(мПутьКФайлуПолный);
	Если Файл.Расширение = ".dll" Тогда

		ПутьККомпоненте = СтрШаблон("/%1/releases/download/v%2/%3",
			"ret-Phoenix/onescript-extensions",
			Версия,
			Файл.Имя);

		ЗапросФайла = Новый HttpЗапрос(ПутьККомпоненте);
		Ответ = Соединение.Получить(ЗапросФайла, Файл.ПолноеИмя);

		Если Не Ответ.КодСостояния = 200 Тогда
			ВызватьИсключение "Нет файлов на гитхабе!";
		КонецЕсли;

	КонецЕсли;

	ВключаемыеФайлы[Инд] = мПутьКФайлу;

КонецЦикла;

// vim: filetype=onescript